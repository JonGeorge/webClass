How to Configure Nginx as a Reverse Proxy
-----------------------------------------


Procedures
----------
 1. Install nginx
 
 2. Modify the /etc/nginx/conf.d/default.conf to include other .conf files
    Add this to conf file:
        include conf.d/proxy/*.conf;

    So, your default.conf looks like this:
    
      server
      {
            listen       80;
            server_name  localhost;
        
        
            location / 
            {
                root   /usr/share/nginx/html;
                index  index.html index.htm;
            }
        
            # redirect server error pages to the static page /50x.html
            #
            error_page   500 502 503 504  /50x.html;
            location = /50x.html 
            {
                root   /usr/share/nginx/html;
            }
      
      
           include conf.d/proxy/*.conf;
      }
      
 3. Setup your other conf file
    unix> mkdir -p /etc/nginx/conf.d/proxy
    unix> vi reverseProxy.conf
    
      location /openam 
      {


        #Add custom header for OpenAM
        proxy_set_header BOGUS_HEADER "Additional Header Information";

        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

        proxy_pass http://10.3.0.21:8080/springMvcWebApp1; 
     }
     
     
 4. Turn on a webapp springMvcWebApp1  [that is listening at http://10.3.0.21:8080/springMvcWebApp1]
 
 
 5. Verify it works, open a few tail windows
    a. On your centos box, Connect to your centos box
       unix> tail -f /var/log/nginx/access.log
       
       unix> tail -f /var/log/nginx/error.log
       
       
   b. On your centos box  [which should now be forwarding to http://10.3.0.21:8080/springMvcWebApp1]
      1) Open a firefox browser
      2) Connect to http://localhost/openam
         -- It should reverse-proxy you to http://10.3.0.21:8080/springMvcWebApp1
       

~                        
