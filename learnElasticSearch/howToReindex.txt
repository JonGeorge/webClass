How to Reindex Data
-------------------

PROBLEM:  You have an alias docs that points to docs_v1
          You have an ES mapping in production called docs_v1
          You need to modify your indexing but you don't want to lose the data
          
SOLUTION: Reindex your data to a new index -- e.g., docs_v2
          Change your alias to point to docs_v2


Assumptions:
 1) You have Maven
 2) You have Java
 3) You have an ES 1.7.5 service on your computer
 4) You have the authority to stop/start this service

          
Reindexing on ES 1.7.5
----------------------
NOTE:  ES 1.x does not have a reindex function built-in

 1. Download and Compile the ES 1.7 version of the reindex plugin
    a. Go to https://github.com/codelibs/elasticsearch-reindexing
    b. Click on Releases
    c. Select elasticsearch-reindexing-1.7.0 
    d. Click on source code (tar.gz)
       -- Save it to your "Downloads" directory
       -- Save the file as "elasticsearch-reindexing-1.7.0.tar.gz"
       
    *OR*
        
    Go to https://github.com/codelibs/elasticsearch-reindexing/archive/elasticsearch-reindexing-1.7.0.tar.gz
       -- Save it to your "Downloads" directory
       -- Save the file as "elasticsearch-reindexing-1.7.0.tar.gz"
    
    e. Compile the plugin  (to generate the elasticsearch-reindexing-1.7.0.jar)
       unix> cd ~/Downloads
       unix> tar zxvf elasticsearch-reindexing-1.7.0.tar.gz
       unix> rm elasticsearch-reindexing-1.7.0.tar.gz
       unix> cd elasticsearch-reindexing-elasticsearch-reindexing-1.7.0
       unix> mvn clean package
             -- If it works, then your jar file is located here
                ./target/elasticsearch-reindexing-1.7.0.jar
                
       
 2. Install the plugin
    a. Create a plugin directory
       unix> sudo mkdir /usr/share/elasticsearch/plugins/reindexing
    
    b. Give Elsaticsearch ownership of it
       unix> sudo chown elasticsearch:elasticsearch -R /usr/share/elasticsearch/plugins/reindexing
       
    c. Copy the file to your new directory
       unix> sudo cp ~/Downloads/elasticsearch-reindexing-elasticsearch-reindexing-1.7.0/target/elasticsearch-reindexing-1.7.0.jar   /usr/share/elasticsearch/plugins/reindexing
     
    d. Verify that the plugin looks good
       unix> ls -l /usr/share/elasticsearch/plugins/reindexing
       -rw-r--r--. 1 root root 48705 May 18 09:58 elasticsearch-reindexing-1.7.0.jar

 3. Restart ElasticSearch & Verify
    a. Restart ElasticSearch
       unix> sudo service elasticsearch restart
    
    b. Verify that the pluugin was loaded
       unix> grep -i reindexingplugin /var/log/elasticsearch/elasticsearch.log
       [2017-05-18 09:59:35,359][INFO ][plugins                  ] [Moira Brandon] loaded [ReindexingPlugin], sites []


 4. Create an index called "docs_v1"
 
 5. Create an alias called "docs" that points to "docs_v1"
 
 6. Add some sample data to "docs_v1"
 
 7. Create a 2nd index called "docs_v2"
    NOTE:  This is the index that has the changes
    
 8. Reindex the data
 
 9. Switch the alias so it points to "docs_v2"
 
 
 
 
 
