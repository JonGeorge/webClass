How to Run a Method in the Background using Executor Class
----------------------------------------------------------

private ThreadPoolExecutor executorService;



private ThreadPoolExecutor getExecutorService()
{
  if (this.executorService == null)
   {
      ArrayBlockingQueue<Runnable> queue = new ArrayBlockingQueue<Runnable>(100);
      this.executorService = new ThreadPoolExecutor(minpoolsizeValue, maxpoolsze, keepAliveTime, keepAliveUnits, queue);
  }
  
  return this.executorService;
}

public void doSomething()
{
   if (runInBackground == true)
    {
       ThreadPoolExecutor executor = getExecutorService();
      
       if (executor.getQueue().remainingCapacity() > 0)
        {
           // There is room in the queue for this request
          executor.execute(new RunnableWorker(message));
          }
      else
        {
            // The queue is full
            logger.warn("I cannot run this request right now -- the queue is full");
        }
    }      
  else
   { 
       // Run in foreground
       new RunnableWorker(message);
    }
}


public class RunnableWorker implements Runnable
{
  String message;
  
   public RunnableWorker(String aMessage)
    {
       this.message = aMessage;
    }
    
   public void run()
    {
      try
        {
        // Do something
        }
        catch (Exception e)
        {
        logger.error(e);
        }
    }
}
