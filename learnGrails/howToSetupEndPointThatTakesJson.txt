How to Setup a Grails End Point that Expects JSON
-------------------------------------------------

Suppose a user will pass-in JSON to your end point like this:

  {
      "name":  "some item"
      "isActive" false
  }
  
to your endpoint called /stuff/add


Then, you need to verify that the JSON is valid:
 
  def add()
  {
    try
    {
       if (! isJsonValid(request.JSON))
       {
          return
       }
      
      // Convert the JSON into a view model
      MyViewModel myViewModel = getViewModelFromJson(request.JSON)
      
      // Call my service with the view model
      myService.add(myViewModel);
      
    }
    catch (Exception e)
     {
       logger.error("Something bad happened in add()", e);
       
       // Tell the caller that something bad happened
       render(status: 500, text: "I did not add this item:\n" + e.toString())
    }  
     
  }
  
  
  private boolean isJsonValid(def aJson)
  {
     if (! aJson) 
     {
        render(status: 500, text: "You did not pass any JSON in")
        return false
     }
     
    if (aJson.get("name") == null)
    {
       // There is no name field
       render(status: 500, text:  "You did not provide a name field in your JSON")
       return false
    }
    
    if (aJson.get("isActive") == null)
    {
       // There is no isActive field
       render(status: 500, text:  "You did not provide an isActive field in your JSON")
    }
    
    if (! isTrueOrFalseString(aJson.isActive)
    {
       // The user provided an isActive string but it is not either true or false
       render(status: 500, text:  "You provided an isActive value but it should be either true or false")
    }
    
    return true;
    }
    
    
